# MCP Image Video Generation Server

ä¸€ä¸ªç”¨äºå›¾åƒå’Œè§†é¢‘ç”Ÿæˆçš„ MCP (Model Context Protocol) æœåŠ¡å™¨ï¼Œæ”¯æŒ BigModel AI å¹³å°çš„ CogView å’Œ CogVideoX æ¨¡å‹ã€‚

## åŠŸèƒ½

- ğŸ¨ **å›¾åƒç”Ÿæˆ**: ä½¿ç”¨ CogView æ¨¡å‹ï¼ˆcogview-4, cogview-4-250304, cogview-3-flashï¼‰ç”Ÿæˆé«˜è´¨é‡å›¾åƒï¼Œé»˜è®¤ä½¿ç”¨ cogview-3-flash å…è´¹æ¨¡å‹
- ğŸ¬ **è§†é¢‘ç”Ÿæˆ**: ä½¿ç”¨ CogVideoX æ¨¡å‹ï¼ˆcogvideox-3, cogvideox-2, cogvideox-flashï¼‰ç”Ÿæˆè§†é¢‘ï¼Œé»˜è®¤ä½¿ç”¨ cogvideox-flash æ¨¡å‹
- âš™ï¸ **é…ç½®ç®¡ç†**: æ”¯æŒç¯å¢ƒå˜é‡é…ç½®å’ŒåŠ¨æ€è®¾ç½®æ›´æ–°
- ğŸ”„ **å¼‚æ­¥å¤„ç†**: æ”¯æŒè§†é¢‘ç”Ÿæˆä»»åŠ¡çŠ¶æ€æŸ¥è¯¢å’Œè‡ªåŠ¨ç­‰å¾…å®Œæˆ
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**: å†…ç½®é‡è¯•æœºåˆ¶å’Œè¯¦ç»†é”™è¯¯ä¿¡æ¯
- ğŸ“ **TypeScript**: å®Œæ•´çš„ç±»å‹å®‰å…¨æ”¯æŒ
- ğŸ”§ **è°ƒè¯•æ”¯æŒ**: å†…ç½® MCP Inspector å’Œ VS Code è°ƒè¯•é…ç½®
- ğŸ¯ **æ— æ°´å°**: é»˜è®¤ç”Ÿæˆæ— æ°´å°å†…å®¹ï¼ˆå¯ä»¥åœ¨ bigmodel.cn å®‰å…¨ç®¡ç†ä¸­å»æ‰æ°´å°ï¼‰

## å®‰è£…

```bash
pnpm add -g image-video-generation-mcp
```

## API Key ç”³è¯·

åœ¨ä½¿ç”¨æœ¬æœåŠ¡å™¨ä¹‹å‰ï¼Œæ‚¨éœ€è¦åœ¨ BigModel.cn å¹³å°ç”³è¯· API Keyã€‚

### ç”³è¯·æ­¥éª¤

1. **è®¿é—® BigModel å¼€æ”¾å¹³å°**

   - æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š[https://bigmodel.cn/](https://bigmodel.cn/)
   - ç‚¹å‡»å³ä¸Šè§’"ç™»å½•"æˆ–"æ³¨å†Œ"

2. **æ³¨å†Œ/ç™»å½•è´¦å·**

   - ä½¿ç”¨æ‰‹æœºå·æˆ–é‚®ç®±æ³¨å†Œè´¦å·
   - å®Œæˆå®åè®¤è¯ï¼ˆæ ¹æ®å¹³å°è¦æ±‚ï¼‰
   - ç™»å½•åˆ°å¼€å‘è€…æ§åˆ¶å°

3. **è·å– API Key**
   - ç‚¹å‡»å³ä¸Šè§’å¤´åƒï¼Œæ‰¾åˆ° API Key åç‚¹å‡»è¿›å…¥
   - æ·»åŠ æ–°çš„ API Keyï¼ˆæ³¨æ„ä¿å¯†ï¼‰

### è´¹ç”¨è¯´æ˜

- **å…è´¹é¢åº¦**: æ–°ç”¨æˆ·é€šå¸¸ä¼šè·å¾—ä¸€å®šçš„å…è´¹è°ƒç”¨é¢åº¦
- **è®¡è´¹æ–¹å¼**: æŒ‰å®é™…è°ƒç”¨æ¬¡æ•°å’Œèµ„æºä½¿ç”¨é‡è®¡è´¹
- **ä½™é¢æŸ¥è¯¢**: åœ¨æ§åˆ¶å°å¯ä»¥æŸ¥çœ‹ä½™é¢å’Œä½¿ç”¨æƒ…å†µ
- **å……å€¼æ–¹å¼**: æ”¯æŒå¤šç§åœ¨çº¿å……å€¼æ–¹å¼

### æ¨¡å‹å®šä»·

| æ¨¡å‹ç±»å‹ | æ¨¡å‹åç§°        | è´¹ç”¨ç±»å‹    | æ¨èåœºæ™¯             |
| -------- | --------------- | ----------- | -------------------- |
| å›¾åƒç”Ÿæˆ | cogview-3-flash | å…è´¹/ä½æˆæœ¬ | å¿«é€ŸåŸå‹ã€æ—¥å¸¸ä½¿ç”¨   |
| å›¾åƒç”Ÿæˆ | cogview-4       | ä»˜è´¹        | é«˜è´¨é‡å›¾åƒã€ä¸“ä¸šç”¨é€” |
| è§†é¢‘ç”Ÿæˆ | cogvideox-flash | ä»˜è´¹        | å¿«é€Ÿè§†é¢‘ç”Ÿæˆ         |
| è§†é¢‘ç”Ÿæˆ | cogvideox-3     | ä»˜è´¹        | æ ‡å‡†è´¨é‡è§†é¢‘         |

> ğŸ’¡ **å»ºè®®**: å¼€å‘å’Œæµ‹è¯•é˜¶æ®µå»ºè®®ä½¿ç”¨å…è´¹æ¨¡å‹ï¼ˆcogview-3-flashï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒæ ¹æ®éœ€æ±‚é€‰æ‹©ä»˜è´¹æ¨¡å‹ã€‚

### API Key ä½¿ç”¨æ³¨æ„äº‹é¡¹

- ğŸ”’ **ä¿å¯†**: API Key ç›¸å½“äºå¯†ç ï¼Œè¯·å‹¿åœ¨ä»£ç ä»“åº“ä¸­å…¬å¼€
- âœ… **æƒé™**: ç¡®ä¿ API Key æœ‰æƒé™è®¿é—®æ‰€éœ€çš„æ¨¡å‹æœåŠ¡
- ğŸ”„ **è½®æ¢**: å®šæœŸæ›´æ¢ API Key ä»¥æé«˜å®‰å…¨æ€§
- ğŸ“Š **ç›‘æ§**: å®šæœŸæ£€æŸ¥ API ä½¿ç”¨é‡å’Œè´¹ç”¨æƒ…å†µ

## é…ç½®

è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export IMAGE_VIDEO_GENERATION_API_KEY="your_api_key_here"
export IMAGE_VIDEO_GENERATION_DEFAULT_IMAGE_MODEL="cogview-3-flash"
export IMAGE_VIDEO_GENERATION_DEFAULT_VIDEO_MODEL="cogvideox-flash"
```

æˆ–åˆ›å»ºé…ç½®æ–‡ä»¶ `.image-video-generation-config.json`ï¼š

```json
{
  "apiKey": "your_api_key_here",
  "defaultImageModel": "cogview-3-flash",
  "defaultVideoModel": "cogvideox-flash",
  "timeout": 30000,
  "maxRetries": 3
}
```

## ä½¿ç”¨æ–¹æ³•

### ä½œä¸º MCP æœåŠ¡å™¨ä½¿ç”¨

åœ¨ä½ çš„ MCP å®¢æˆ·ç«¯é…ç½®ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "image-video-generation": {
      "command": "npx",
      "args": ["image-video-generation-mcp@latest"],
      "env": {
        "IMAGE_VIDEO_GENERATION_API_KEY": "your_api_key"
      }
    }
  }
}
```

> **æ³¨æ„**: æ¨¡å‹é…ç½®æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå°†ä½¿ç”¨é»˜è®¤æ¨¡å‹ï¼š
>
> - é»˜è®¤å›¾åƒæ¨¡å‹: `cogview-3-flash`
> - é»˜è®¤è§†é¢‘æ¨¡å‹: `cogvideox-flash`

### ç¯å¢ƒå˜é‡è¯´æ˜

| ç¯å¢ƒå˜é‡                                     | å¿…éœ€ | é»˜è®¤å€¼            | è¯´æ˜             |
| -------------------------------------------- | ---- | ----------------- | ---------------- |
| `IMAGE_VIDEO_GENERATION_API_KEY`             | âœ…   | -                 | API å¯†é’¥         |
| `IMAGE_VIDEO_GENERATION_DEFAULT_IMAGE_MODEL` | âŒ   | `cogview-3-flash` | é»˜è®¤å›¾åƒç”Ÿæˆæ¨¡å‹ |
| `IMAGE_VIDEO_GENERATION_DEFAULT_VIDEO_MODEL` | âŒ   | `cogvideox-flash` | é»˜è®¤è§†é¢‘ç”Ÿæˆæ¨¡å‹ |

### æ”¯æŒçš„å·¥å…·

#### 1. generate_image

ç”Ÿæˆå›¾åƒï¼Œæ”¯æŒä»¥ä¸‹å‚æ•°ï¼š

- `prompt` (å¿…éœ€): å›¾åƒæè¿°æ–‡æœ¬
- `model`: æ¨¡å‹é€‰æ‹© (`cogview-4`, `cogview-4-250304`, `cogview-3-flash`)
- `quality`: å›¾åƒè´¨é‡ (`standard`, `hd`)
- `size`: å›¾åƒå°ºå¯¸ (ä¾‹å¦‚ `1024x1024`)
- `watermark_enabled`: æ˜¯å¦æ·»åŠ æ°´å°
- `user_id`: ç”¨æˆ·è¿½è¸ª ID

#### 2. generate_video

ç”Ÿæˆè§†é¢‘ï¼Œæ”¯æŒä»¥ä¸‹å‚æ•°ï¼š

- `prompt` (å¿…éœ€): è§†é¢‘æè¿°æ–‡æœ¬ (æœ€å¤§ 512 å­—ç¬¦)
- `model`: æ¨¡å‹é€‰æ‹© (`cogvideox-3`, `cogvideox-2`, `cogvideox-flash`)
- `quality`: è¾“å‡ºè´¨é‡æ¨¡å¼ (`speed`, `quality`)
- `size`: è§†é¢‘åˆ†è¾¨ç‡ (ä¾‹å¦‚ `1920x1080`)
- `fps`: å¸§ç‡ (30, 60)
- `duration`: è§†é¢‘æ—¶é•¿ (5, 10 ç§’)
- `with_audio`: æ˜¯å¦å¯ç”¨ AI ç”ŸæˆéŸ³é¢‘
- `watermark_enabled`: æ˜¯å¦æ§åˆ¶æ°´å°

#### 3. query_video_result

æŸ¥è¯¢å¼‚æ­¥è§†é¢‘ç”Ÿæˆä»»åŠ¡ç»“æœï¼š

- `task_id` (å¿…éœ€): è§†é¢‘ç”Ÿæˆä»»åŠ¡è¿”å›çš„ ID

#### 4. wait_for_video

ç­‰å¾…è§†é¢‘ç”Ÿæˆå®Œæˆå¹¶è¿”å›ç»“æœï¼š

- `task_id` (å¿…éœ€): ä»»åŠ¡ ID
- `max_wait_time`: æœ€å¤§ç­‰å¾…æ—¶é—´ (é»˜è®¤ 300000 æ¯«ç§’)
- `poll_interval`: è½®è¯¢é—´éš” (é»˜è®¤ 5000 æ¯«ç§’)

#### 5. configure_models

é…ç½®é»˜è®¤æ¨¡å‹å’Œè®¾ç½®ï¼š

- `default_image_model`: é»˜è®¤å›¾åƒç”Ÿæˆæ¨¡å‹
- `default_video_model`: é»˜è®¤è§†é¢‘ç”Ÿæˆæ¨¡å‹
- `timeout`: è¯·æ±‚è¶…æ—¶æ—¶é—´
- `max_retries`: æœ€å¤§é‡è¯•æ¬¡æ•°

## é»˜è®¤æ¨¡å‹

- **å›¾åƒç”Ÿæˆ**: `cogview-3-flash` (å…è´¹æ¨¡å‹ï¼Œå¿«é€Ÿç”Ÿæˆ)
- **è§†é¢‘ç”Ÿæˆ**: `cogvideox-flash` (å¿«é€Ÿè§†é¢‘ç”Ÿæˆ)

## å¼€å‘

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/156554395/image-video-generation-mcp.git
cd image-video-generation-mcp

# å®‰è£…ä¾èµ–
pnpm install

# å¼€å‘æ¨¡å¼
pnpm dev

# è¿è¡Œæµ‹è¯•
pnpm test

# æ„å»º
pnpm build
```

## å‘å¸ƒ

### å‘å¸ƒåˆ° npm

```bash
# ç™»å½• npmï¼ˆå¦‚æœå°šæœªç™»å½•ï¼‰
npm login

# å‘å¸ƒæ–°ç‰ˆæœ¬
pnpm release

# æˆ–è€…æ‰‹åŠ¨å‘å¸ƒ
pnpm build
pnpm test
npm publish
```

### å‘å¸ƒè„šæœ¬è¯´æ˜

- `prepublishOnly`: å‘å¸ƒå‰è‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•
- `prepack`: æ‰“åŒ…å‰è‡ªåŠ¨æ„å»º
- `release`: å®Œæ•´çš„å‘å¸ƒæµç¨‹ï¼ˆæ„å»º â†’ æµ‹è¯• â†’ å‘å¸ƒï¼‰

### å‘å¸ƒæ–‡ä»¶è¯´æ˜

é€šè¿‡ `package.json` ä¸­çš„ `files` å­—æ®µå’Œ `.npmignore` æ–‡ä»¶ï¼Œå‘å¸ƒåŒ…å°†åªåŒ…å«ï¼š

**åŒ…å«çš„æ–‡ä»¶ï¼š**

- `dist/` - æ„å»ºåçš„ JavaScript å’Œ TypeScript å£°æ˜æ–‡ä»¶
- `README.md` - é¡¹ç›®æ–‡æ¡£
- `LICENSE` - è®¸å¯è¯æ–‡ä»¶

**æ’é™¤çš„æ–‡ä»¶ï¼š**

- `src/` - æºä»£ç ç›®å½•
- `scripts/` - å¼€å‘è„šæœ¬
- æµ‹è¯•æ–‡ä»¶å’Œè°ƒè¯•æ–‡ä»¶
- é…ç½®æ–‡ä»¶å’Œå¼€å‘å·¥å…·æ–‡ä»¶

### ç‰ˆæœ¬ç®¡ç†

```bash
# æ›´æ–°è¡¥ä¸ç‰ˆæœ¬ (1.0.0 -> 1.0.1)
npm version patch

# æ›´æ–°æ¬¡ç‰ˆæœ¬ (1.0.0 -> 1.1.0)
npm version minor

# æ›´æ–°ä¸»ç‰ˆæœ¬ (1.0.0 -> 2.0.0)
npm version major

# é¢„å‘å¸ƒç‰ˆæœ¬ (1.0.0 -> 1.0.1-beta.0)
npm version prerelease --preid=beta
```

## è°ƒè¯•

### ä½¿ç”¨ VS Code è°ƒè¯•

1. **ä½¿ç”¨ VS Code è°ƒè¯•é…ç½®**ï¼š

   - æ‰“å¼€ VS Code
   - æŒ‰ `F5` æˆ–ç‚¹å‡»è°ƒè¯•é¢æ¿
   - é€‰æ‹© "Debug MCP Server" é…ç½®
   - è®¾ç½®æ–­ç‚¹å¹¶å¼€å§‹è°ƒè¯•

2. **è°ƒè¯•é…ç½®é€‰é¡¹**ï¼š
   - `Debug MCP Server`: æ™®é€šè°ƒè¯•æ¨¡å¼
   - `Debug MCP Server (Break at Start)`: å¯åŠ¨æ—¶æš‚åœ
   - `Debug Tests`: è°ƒè¯•æµ‹è¯•ä»£ç 

### ä½¿ç”¨å‘½ä»¤è¡Œè°ƒè¯•

1. **å¯åŠ¨è°ƒè¯•æœåŠ¡å™¨**ï¼š

   ```bash
   # æ„å»ºé¡¹ç›®
   pnpm build

   # å¯åŠ¨è°ƒè¯•ï¼ˆåœ¨ç¬¬ä¸€è¡Œæ–­ç‚¹ï¼‰
   pnpm debug:break

   # æˆ–è€…å¯åŠ¨è°ƒè¯•ï¼ˆä¸åœ¨ç¬¬ä¸€è¡Œæ–­ç‚¹ï¼‰
   pnpm debug
   ```

2. **ä½¿ç”¨ Chrome DevTools**ï¼š

   - æ‰“å¼€ Chrome æµè§ˆå™¨
   - è®¿é—® `chrome://inspect`
   - ç‚¹å‡» "Open dedicated DevTools for Node"
   - åœ¨ DevTools ä¸­æŸ¥çœ‹å’Œæ§åˆ¶è°ƒè¯•

3. **ä½¿ç”¨ Node Inspector**ï¼š

   ```bash
   # ä½¿ç”¨ inspector
   node --inspect --inspect-port=9229 dist/index.js

   # ä½¿ç”¨ inspector-brkï¼ˆå¯åŠ¨æ—¶æš‚åœï¼‰
   node --inspect-brk --inspect-port=9229 dist/index.js
   ```

### è°ƒè¯•ç¯å¢ƒå˜é‡

```bash
# è®¾ç½®è°ƒè¯•ç¯å¢ƒå˜é‡
export NODE_ENV=development
export DEBUG=mcp:*
```

### ä½¿ç”¨ MCP Inspector (æ¨è)

1. **å¯åŠ¨ MCP Inspector**ï¼š

   ```bash
   # æ„å»ºé¡¹ç›®
   pnpm build

   # ä½¿ç”¨ MCP Inspectorï¼ˆæ¨èæ–¹å¼ï¼‰
   pnpm inspector

   # æˆ–è€…ç›´æ¥ä½¿ç”¨ npx
   pnpm inspector:direct
   ```

2. **MCP Inspector åŠŸèƒ½**ï¼š

   - ğŸ¯ **å¯è§†åŒ–è°ƒè¯•**: ç›´è§‚çš„ Web ç•Œé¢è°ƒè¯• MCP æœåŠ¡å™¨
   - ğŸ› ï¸ **å·¥å…·æµ‹è¯•**: ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•æ‰€æœ‰ MCP å·¥å…·
   - ğŸ“ **å®æ—¶æ—¥å¿—**: æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯
   - ğŸ”§ **å‚æ•°ç¼–è¾‘**: åŠ¨æ€ä¿®æ”¹è¯·æ±‚å‚æ•°è¿›è¡Œæµ‹è¯•
   - ğŸ“Š **å“åº”é¢„è§ˆ**: æŸ¥çœ‹å·¥å…·æ‰§è¡Œçš„è¯¦ç»†å“åº”

3. **Inspector ä½¿ç”¨æ–¹æ³•**ï¼š
   - è¿è¡Œ `pnpm inspector` å‘½ä»¤
   - æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ Inspector ç•Œé¢
   - åœ¨å·¦ä¾§é€‰æ‹©è¦æµ‹è¯•çš„å·¥å…·
   - å¡«å†™å‚æ•°å¹¶ç‚¹å‡»"Execute"æ‰§è¡Œ
   - åœ¨å³ä¾§æŸ¥çœ‹æ‰§è¡Œç»“æœå’Œæ—¥å¿—

### è°ƒè¯•æŠ€å·§

- **æ–­ç‚¹è°ƒè¯•**: åœ¨æºä»£ç ä¸­è®¾ç½®æ–­ç‚¹ï¼Œè°ƒè¯•å™¨ä¼šåœ¨è¿™äº›ç‚¹æš‚åœæ‰§è¡Œ
- **æ§åˆ¶å°è¾“å‡º**: ä½¿ç”¨ `console.log()` è¾“å‡ºè°ƒè¯•ä¿¡æ¯
- **å˜é‡ç›‘è§†**: åœ¨è°ƒè¯•å™¨ä¸­ç›‘è§†å˜é‡å€¼çš„å˜åŒ–
- **è°ƒç”¨å †æ ˆ**: æŸ¥çœ‹å‡½æ•°è°ƒç”¨é“¾ï¼Œäº†è§£ç¨‹åºæ‰§è¡Œæµç¨‹
- **çƒ­é‡è½½**: ä½¿ç”¨ `pnpm dev` è¿›è¡Œå¼€å‘ï¼Œè‡ªåŠ¨é‡æ–°ç¼–è¯‘
- **MCP Inspector**: æœ€ä½³è°ƒè¯•æ–¹å¼ï¼Œæä¾›å®Œæ•´çš„å¯è§†åŒ–å’Œäº¤äº’åŠŸèƒ½

## è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### è´¡çŒ®è€…

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ [GitHub Issues](https://github.com/156554395/image-video-generation-mcp/issues)ã€‚

## ç›¸å…³é“¾æ¥

- [BigModel API æ–‡æ¡£](https://docs.bigmodel.cn/)
- [MCP åè®®](https://modelcontextprotocol.io/)
